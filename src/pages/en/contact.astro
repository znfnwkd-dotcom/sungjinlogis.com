---
import BaseLayout from '../../layouts/BaseLayout.astro';

const title = 'Contact | SUNGJINLOGIS';
const description = 'Contact us â€” technical & quality-focused consultation.';
---

<BaseLayout title={title} description={description} lang="en" pathPrefix="/en">
  <section class="rounded-xl2 border border-stroke bg-surface p-8 shadow-soft">
    <h1 class="text-2xl font-semibold">Contact</h1>
    <p class="mt-2 text-sm text-sub">
      We prioritize technical and quality-focused consultation over simple price-only inquiries.
    </p>

    <div class="mt-6 rounded-xl border border-stroke bg-base p-5">
      <div class="text-sm font-semibold">Email</div>
      <p class="mt-1 text-sm text-sub">
        <a class="text-text hover:text-accent" href="mailto:chiwon1@kakao.net">chiwon1@kakao.net</a>
      </p>
    </div>

    <form id="contactForm" class="mt-8 grid gap-4 md:max-w-xl">
      <label class="grid gap-2">
        <span class="text-sm text-sub">Email *</span>
        <input
          class="rounded-xl border border-stroke bg-base px-4 py-3 text-sm"
          type="email"
          name="email"
          required
          placeholder="name@company.com"
          autocomplete="email"
        />
      </label>

      <label class="grid gap-2">
        <span class="text-sm text-sub">Subject</span>
        <input
          class="rounded-xl border border-stroke bg-base px-4 py-3 text-sm"
          type="text"
          name="subject"
          placeholder="Subject"
          autocomplete="off"
        />
      </label>

      <label class="grid gap-2">
        <span class="text-sm text-sub">Message *</span>
        <textarea
          class="min-h-[140px] rounded-xl border border-stroke bg-base px-4 py-3 text-sm"
          name="message"
          required
          placeholder="Message"
        ></textarea>
      </label>

      {/* Honeypot (spam bot trap) */}
      <label class="hidden">
        <span>Leave this field empty</span>
        <input type="text" name="hp" tabindex="-1" autocomplete="off" />
      </label>

      <button
        class="rounded-xl bg-accent px-4 py-3 text-sm font-semibold text-white hover:bg-accent-hover transition"
        type="submit"
      >
        Send inquiry
      </button>

      <p id="contactStatus" class="text-sm text-sub"></p>
    </form>
  </section>

  <script is:inline>
    {`
      (() => {
        const form = document.getElementById('contactForm');
        const statusEl = document.getElementById('contactStatus');
        if (!form || !statusEl) return;

        const setStatus = (msg) => (statusEl.textContent = msg);

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          setStatus('Sending...');

          const fd = new FormData(form);

          try {
            const res = await fetch('/api/contact', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                email: fd.get('email'),
                subject: fd.get('subject'),
                message: fd.get('message'),
                hp: fd.get('hp'),
                lang: 'en',
              }),
            });

            if (!res.ok) {
              const msg = await res.text();
              throw new Error(msg || 'Request failed');
            }

            setStatus('Sent! We will review and get back to you soon.');
            form.reset();
          } catch (err) {
            setStatus('Something went wrong. Please try again in a moment.');
          }
        });
      })();
    `}
  </script>
</BaseLayout>
